"use strict";var pendingForm;const alertBox=$(".js-alert");$(function(){$("#sortable").sortable({axis:"y",cursor:"move",cancel:".dd-content"})}),$(document).on("submit","form#layout_selector",function(a){a.preventDefault();let b=this.action.replace("__file",this.querySelector("#l_layout").value);updateFormButton(this),ajaxRequest($(this),b,replaceForm)}),$(document).on("change",".category_type",function(){"selectedCategories"==this.value?this.closest("form").querySelector(".cats").classList.remove("d-none"):this.closest("form").querySelector(".cats").classList.add("d-none")}),$(document).on("change","#brand_type",function(){"selectedBrands"==this.value?this.closest("form").querySelector(".cats").classList.remove("d-none"):this.closest("form").querySelector(".cats").classList.add("d-none")}),$(document).on("change","#blog_type",function(){"selectedBlogs"==this.value?this.closest("form").querySelector(".cats").classList.remove("d-none"):this.closest("form").querySelector(".cats").classList.add("d-none")}),$(document).on("submit","form.component_form",function(a){a.preventDefault();let b=this.action.replace("__id",__page);updateFormButton(getDraggableParent(this)),$.makeAjaxCall($(this),b,{success:updateComponent,failed:updateComponent,type:"post"})}),$(document).on("keyup",".section_name",function(){let a=getDraggableParent(this);a.find(".header-title").html(filterXSS(this.value))}),$(document).on("click","#update_page",function(){$(this).find(".loading-spinner").toggleClass("d-none");var a=0;$("#sortable").find("form.component_form").each(function(){let b=$(this).find("input,select,textarea").serialize();$("#internal_form").append(`<input type="hidden" class="temp-input" name="component[${a++}]" value="${b}">`)}),$.makeAjaxCall($("#internal_form"),__savePageUrl,{success:pageUpdated,type:"post"})}),$(document).on("click","#add-new-widget",function(){sortable.append(selector),$("html, body").animate({scrollTop:$(document).height()},"slow"),updateSelect2Fields()}),$(document).on("change","#l_category",function(){$(this).closest("form").find(".layoutBlocks").addClass("d-none"),$(this).closest("form").find("#"+this.value).removeClass("d-none")});const ajaxRequest=(a,b,c,d="get")=>{let e={};if(a){var f=a.find("input, select, button, textarea");a.serializeArray().forEach(a=>{let[b,c]=[a.name,a.value];b.endsWith("[]")?(b=b.slice(0,-2),!e[b]&&(e[b]=[]),e[b].push(c)):e[b]=c}),f.prop("disabled",!0)}pendingForm=a,$.ajax({url:b,type:d,dataType:"json",data:e,success:function(b){c(a,b.body),f.prop("disabled",!1),ajaxUpdated(),removeButtonLoader()},error:function(b,c,d){throw f.prop("disabled",!1),operationFailed(jsLang("Operation failed.")),updateAjaxMessage(a,jsLang("Operation failed."),"danger"),updateFormButton(a),ajaxFailed(),removeButtonLoader(),d}})},replaceForm=(a,b)=>{let c=getDraggableParent(a);c.find(".header-title").html(b.title),c.find(".header-text").append(b.header),c.attr("data-id",b.level),c.find(".dd-content").remove(),c.append(b.html),$("#sortable").trigger("sortstop"),$("#update_page .loading-spinner").toggleClass("d-none"),operationSuccess(jsLang("Section added. Please fill up the section information and save.")),updateSelect2Fields()},updateComponent=(a,b)=>{let c=$(a.form);c.closest(".ui-state-default").find(".delete-button").attr("data-component-id",b.body),c.find(".component").prop("value",b.body),updateFormButton(getDraggableParent(c)),updateAjaxMessage(getDraggableParent(c),jsLang("Section updated.")),operationSuccess(jsLang("Section Updated"))},getDraggableParent=a=>$(a).closest(".ui-state-default"),deletedGrid=a=>{a?operationSuccess(jsLang("Section deleted")):operationFailed(jsLang("Couldn't delete the section"))},updateCustomForm=a=>{document.querySelector("#internal_form #data").value=a},pageUpdated=()=>{$("#update_page .loading-spinner").toggleClass("d-none"),$(".temp-input").remove(),window.location.reload()},operationSuccess=a=>{showNotification("success",jsLang(a))},operationFailed=a=>{showNotification("danger",jsLang(a))},showNotification=(a,b)=>{alertBox.find(".alertText").html(b),alertBox.find(".alert").attr("class",`alert alert-${a}`),alertBox.removeClass("d-none")};$(".close").on("click",function(){alertBox.addClass("d-none")});const showSliderOptions=a=>{let b=getDraggableParent(a);$(b).find(".sliderOptions").removeClass("d-none").addClass("d-flex"),hideBannerOptions(b),hideFlashOptions(b)},hideSliderOptions=a=>{$(a).find(".sliderOptions").addClass("d-none").removeClass("d-flex")},showBannerOptions=a=>{let b=getDraggableParent(a);$(b).find(".bannerOptions").removeClass("d-none").addClass("d-flex"),hideSliderOptions(b),hideFlashOptions(b)},hideBannerOptions=a=>{$(a).find(".bannerOptions").removeClass("d-flex").addClass("d-done")},showFlashOptions=a=>{let b=getDraggableParent(a);$(b).find(".flashOptions").addClass("d-flex").removeClass("d-none"),hideSliderOptions(b),hideBannerOptions(b)},hideFlashOptions=a=>{$(a).find(".flashOptions").addClass("d-none").removeClass("d-flex")},hideAllOptions=a=>{let b=getDraggableParent(a);hideSliderOptions(b),hideBannerOptions(b),hideFlashOptions(b),toggleSidebar(a,!1)},updateSelect2Fields=()=>{$("select.select2").select2({placeholder:jsLang("Select an option")}),$(".select3").select2({placeholder:jsLang("Select an option")})};$(document).on("select2:select","select.select2",function(a){var b=a.params.data.element,c=$(b);c.detach(),$(this).append(c),$(this).trigger("change")}),updateSelect2Fields(),$(document).on("change",".sidebar_options",function(){"0"==this.value?hideAllOptions(this):"slide"==this.value?(showBannerOptions(this),toggleSidebar(this,!0)):"slider"==this.value?(showSliderOptions(this),toggleSidebar(this,!0)):"flash_sale"==this.value&&(showFlashOptions(this),toggleSidebar(this,!0)),$(".product-col").trigger("change")}),$(document).ready(function(){updateSelect2Fields(),$(".select2").on("select2:select",function(a){var b=a.params.data.element,c=$(b);c.detach(),$(this).append(c),$(this).trigger("change")})}),$(document).on("click",".folding",function(){let a=this.closest(".ui-state-default");this.classList.contains("closed")?($(a).find(".dd-content").removeClass("card-hide"),$(this).removeClass("closed")):($(a).find(".dd-content").addClass("card-hide"),$(this).addClass("closed"))}),$(document).on("click",".header-text",function(){$(this).closest(".ui-state-default").find(".folding").trigger("click")}),$(document).on("click",".delete-button",function(){$("#component-title").html(filterXSS($(this).data("component"))),deletingSection=this.closest(".ui-state-default"),deletingSectionId=$(this).data("component-id")}),$(document).on("click",".delete-section-btn",function(){toggleDeleteLoading(),updateCustomForm(deletingSectionId),"0"===deletingSectionId||0===deletingSectionId?gridDeleted(null,!0):ajaxRequest($("#internal_form"),__gridDeleteUrl,gridDeleted,"post")});const toggleDeleteLoading=()=>{$(".delete-loading").toggleClass("d-none")},gridDeleted=(a,b)=>{$(".modal").modal("hide"),toggleDeleteLoading(),$(".delete-section-btn .spinner-border").remove(),$(".delete-section-btn").removeClass("disabled-btn"),$(".delete-section-btn").text(jsLang("Delete")),b?(deletingSection.remove(),operationSuccess("Section deleted")):operationFailed("Section couldn't be deleted."),deletingSection=void 0,deletingSectionId=void 0},updateFormButton=a=>{$(a).find(".loading-spinner").toggleClass("d-none"),$("#update_page .loading-spinner").toggleClass("d-none")},updateAjaxMessage=(a,b,c="success")=>{$(a).find(".message").html(b),$(a).find(".message").addClass(`text-${c}`),setTimeout(a=>{$(a).find(".message").html("")},3e3)};$(".img-delete-icon").on("click",function(){let a=$(this).closest(".form-group");$(a).find(".custom-file-input").val(""),$(this).closest(".preview-image").html("")});const toggleSidebar=(a,b=!0)=>{let c=getDraggableParent(a);b?$(c).find(".sidebarOption").removeClass("d-none"):$(c).find(".sidebarOption").addClass("d-none")};$(document).on("change",".seeMore",function(){let a=getDraggableParent(this);$(a).find(".moreLink").toggleClass("d-none")}),$(document).on("click",".selectable",function(){$(this).closest("form").find(".selectable").removeClass("selectedBox"),$(this).closest("form").find("#l_layout").val($(this).data("val")),$(this).addClass("selectedBox")}),$(document).on("file-attached",".media-manager",function(a,b){let c=b.data[0],d=$(this).data("name");$($(this).closest(".form-group")).find(".preview-image").html(imagePreview(c,d))});const imagePreview=(a,b)=>`<div class="d-flex flex-wrap mt-2">
